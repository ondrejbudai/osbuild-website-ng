"use strict";(self.webpackChunkosbuild_website_ng=self.webpackChunkosbuild_website_ng||[]).push([[7238],{3905:(e,t,n)=>{n.d(t,{Zo:()=>d,kt:()=>g});var a=n(7294);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function l(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?l(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):l(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function o(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},l=Object.keys(e);for(a=0;a<l.length;a++)n=l[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(a=0;a<l.length;a++)n=l[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var p=a.createContext({}),s=function(e){var t=a.useContext(p),n=t;return e&&(n="function"==typeof e?e(t):i(i({},t),e)),n},d=function(e){var t=s(e.components);return a.createElement(p.Provider,{value:t},e.children)},m="mdxType",u={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},c=a.forwardRef((function(e,t){var n=e.components,r=e.mdxType,l=e.originalType,p=e.parentName,d=o(e,["components","mdxType","originalType","parentName"]),m=s(n),c=r,g=m["".concat(p,".").concat(c)]||m[c]||u[c]||l;return n?a.createElement(g,i(i({ref:t},d),{},{components:n})):a.createElement(g,i({ref:t},d))}));function g(e,t){var n=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var l=n.length,i=new Array(l);i[0]=c;var o={};for(var p in t)hasOwnProperty.call(t,p)&&(o[p]=t[p]);o.originalType=e,o[m]="string"==typeof e?e:r,i[1]=o;for(var s=2;s<l;s++)i[s]=n[s];return a.createElement.apply(null,i)}return a.createElement.apply(null,n)}c.displayName="MDXCreateElement"},1340:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>p,contentTitle:()=>i,default:()=>u,frontMatter:()=>l,metadata:()=>o,toc:()=>s});var a=n(7462),r=(n(7294),n(3905));const l={},i="OpenSCAP Remediation",o={unversionedId:"image-builder-on-premises/oscap-remediation",id:"image-builder-on-premises/oscap-remediation",title:"OpenSCAP Remediation",description:"osbuild-composer now provides the ability to build security hardened images using the [OpenSCAP] tool.",source:"@site/docs/image-builder-on-premises/oscap-remediation.md",sourceDirName:"image-builder-on-premises",slug:"/image-builder-on-premises/oscap-remediation",permalink:"/osbuild-website-ng/docs/image-builder-on-premises/oscap-remediation",draft:!1,editUrl:"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/image-builder-on-premises/oscap-remediation.md",tags:[],version:"current",frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"Managing repositories",permalink:"/osbuild-website-ng/docs/image-builder-on-premises/managing-repositories"},next:{title:"Third-party Repositories",permalink:"/osbuild-website-ng/docs/image-builder-on-premises/repository-customizations"}},p={},s=[{value:"OpenSCAP",id:"openscap",level:2},{value:"Build-time Remedation",id:"build-time-remedation",level:2},{value:"Openscap Example",id:"openscap-example",level:2},{value:"Supported profiles",id:"supported-profiles",level:2}],d={toc:s},m="wrapper";function u(e){let{components:t,...n}=e;return(0,r.kt)(m,(0,a.Z)({},d,n,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("h1",{id:"openscap-remediation"},"OpenSCAP Remediation"),(0,r.kt)("p",null,(0,r.kt)("inlineCode",{parentName:"p"},"osbuild-composer")," now provides the ability to build security hardened images using the ",(0,r.kt)("a",{parentName:"p",href:"https://github.com/OpenSCAP/openscap/blob/maint-1.3/docs/manual/manual.adoc"},"OpenSCAP")," tool.\nThis feature is available for ",(0,r.kt)("inlineCode",{parentName:"p"},"RHEL 8.7")," (& above) and ",(0,r.kt)("inlineCode",{parentName:"p"},"RHEL 9.1")," (& above)."),(0,r.kt)("h2",{id:"openscap"},"OpenSCAP"),(0,r.kt)("p",null,"The ",(0,r.kt)("inlineCode",{parentName:"p"},"OpenSCAP")," tool enables users to scan images for vulnerabilities and then remediate the non-compliances according to\npre-defined security standards. A limitation of this is that it is not always trivial to fix all issues after the first\nboot of the image."),(0,r.kt)("h2",{id:"build-time-remedation"},"Build-time Remedation"),(0,r.kt)("p",null,"To solve this issue, an ",(0,r.kt)("a",{parentName:"p",href:"https://github.com/osbuild/osbuild/blob/main/stages/org.osbuild.oscap.remediation"},"osbuild stage")," runs the ",(0,r.kt)("inlineCode",{parentName:"p"},"OpenSCAP")," tool on the filesystem tree while the image is being built. The ",(0,r.kt)("inlineCode",{parentName:"p"},"OpenSCAP")," tool runs\nthe standard evaluation for the given profile and applies the remediations to the image. This process enables the user to build a more completely\nhardened image compared to running the remediation on a live system."),(0,r.kt)("h2",{id:"openscap-example"},"Openscap Example"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},'[customizations.openscap]\nprofile_id = "xccdf_org.ssgproject.content_profile_standard"\ndatastream = "/usr/share/xml/scap/ssg/content/ssg-fedora-ds.xml"\n')),(0,r.kt)("p",null,(0,r.kt)("inlineCode",{parentName:"p"},"osbuild-composer")," exposes to fields for the user to customize in the image blueprints: "),(0,r.kt)("p",null,"  1) The path to the ",(0,r.kt)("inlineCode",{parentName:"p"},"datastream")," instructions (most likely in the ",(0,r.kt)("inlineCode",{parentName:"p"},"/usr/share/xml/scap/ssg/content/")," directory)\n2) The ",(0,r.kt)("inlineCode",{parentName:"p"},"profile_id")," for the desired security standard\n3) Install openscap via this command: ",(0,r.kt)("inlineCode",{parentName:"p"},"dnf install scap-security-guide"),"\n4) Use the command ",(0,r.kt)("inlineCode",{parentName:"p"},"oscap info /usr/share/xml/scap/ssg/content/<security_profile>.xml")," to obtain more information such as the profile id to use\n5) The ",(0,r.kt)("inlineCode",{parentName:"p"},"profile_id")," field accepts both the long and short forms, i.e. ",(0,r.kt)("inlineCode",{parentName:"p"},"cis")," or ",(0,r.kt)("inlineCode",{parentName:"p"},"xccdf_org.ssgproject.content_profile_cis"),"."),(0,r.kt)("p",null,"See the below table for supported profiles."),(0,r.kt)("p",null,(0,r.kt)("inlineCode",{parentName:"p"},"osbuild-composer")," will then generate the necessary configurations for the ",(0,r.kt)("inlineCode",{parentName:"p"},"osbuild")," stage based on the the\nuser customizations. Additionally, two packages will be added to the image, ",(0,r.kt)("inlineCode",{parentName:"p"},"openscap-scanner")," (the ",(0,r.kt)("inlineCode",{parentName:"p"},"OpenSCAP")," tool)\n& ",(0,r.kt)("inlineCode",{parentName:"p"},"scap-security-guide")," (this package contains the remediation instructions)."),(0,r.kt)("blockquote",null,(0,r.kt)("p",{parentName:"blockquote"},"\u26a0\ufe0f ",(0,r.kt)("strong",{parentName:"p"},"Note"),"\nThe the remediation stage assumes that the\n",(0,r.kt)("inlineCode",{parentName:"p"},"scap-security-guide")," will be used for the datastream. This pacakge is installed on the image by default. If another datastream is desired, add the necessary package to the blueprint and specify the path to the datastream in the oscap config.")),(0,r.kt)("h2",{id:"supported-profiles"},"Supported profiles"),(0,r.kt)("p",null,"The supported profiles are distro specific, see below:"),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:null}),(0,r.kt)("th",{parentName:"tr",align:null},"Fedora"),(0,r.kt)("th",{parentName:"tr",align:null},"RHEL 8.7^"),(0,r.kt)("th",{parentName:"tr",align:null},"CS9/RHEL 9.1^"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"ANSSI-BP-028 (enhanced)"),(0,r.kt)("td",{parentName:"tr",align:null}),(0,r.kt)("td",{parentName:"tr",align:null},"x"),(0,r.kt)("td",{parentName:"tr",align:null},"x")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"ANSSI-BP-028 (high)"),(0,r.kt)("td",{parentName:"tr",align:null}),(0,r.kt)("td",{parentName:"tr",align:null},"x"),(0,r.kt)("td",{parentName:"tr",align:null},"x")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"ANSSI-BP-028 (intermediary)"),(0,r.kt)("td",{parentName:"tr",align:null}),(0,r.kt)("td",{parentName:"tr",align:null},"x"),(0,r.kt)("td",{parentName:"tr",align:null},"x")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"ANSSI-BP-028 (minimal)"),(0,r.kt)("td",{parentName:"tr",align:null}),(0,r.kt)("td",{parentName:"tr",align:null},"x"),(0,r.kt)("td",{parentName:"tr",align:null},"x")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"CIS Level 2 - Server"),(0,r.kt)("td",{parentName:"tr",align:null}),(0,r.kt)("td",{parentName:"tr",align:null},"x"),(0,r.kt)("td",{parentName:"tr",align:null},"x")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"CIS Level 1 - Server"),(0,r.kt)("td",{parentName:"tr",align:null}),(0,r.kt)("td",{parentName:"tr",align:null},"x"),(0,r.kt)("td",{parentName:"tr",align:null},"x")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"CIS Level 1 - Workstation"),(0,r.kt)("td",{parentName:"tr",align:null}),(0,r.kt)("td",{parentName:"tr",align:null},"x"),(0,r.kt)("td",{parentName:"tr",align:null},"x")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"CIS Level 2 - Workstation"),(0,r.kt)("td",{parentName:"tr",align:null}),(0,r.kt)("td",{parentName:"tr",align:null},"x"),(0,r.kt)("td",{parentName:"tr",align:null},"x")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"CUI"),(0,r.kt)("td",{parentName:"tr",align:null}),(0,r.kt)("td",{parentName:"tr",align:null},"x"),(0,r.kt)("td",{parentName:"tr",align:null},"x")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"Essential Eight"),(0,r.kt)("td",{parentName:"tr",align:null}),(0,r.kt)("td",{parentName:"tr",align:null},"x"),(0,r.kt)("td",{parentName:"tr",align:null},"x")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"HIPAA"),(0,r.kt)("td",{parentName:"tr",align:null}),(0,r.kt)("td",{parentName:"tr",align:null},"x"),(0,r.kt)("td",{parentName:"tr",align:null},"x")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"ISM Official"),(0,r.kt)("td",{parentName:"tr",align:null}),(0,r.kt)("td",{parentName:"tr",align:null},"x"),(0,r.kt)("td",{parentName:"tr",align:null},"x")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"OSPP"),(0,r.kt)("td",{parentName:"tr",align:null},"x"),(0,r.kt)("td",{parentName:"tr",align:null},"x"),(0,r.kt)("td",{parentName:"tr",align:null},"x")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"PCI-DSS"),(0,r.kt)("td",{parentName:"tr",align:null},"x"),(0,r.kt)("td",{parentName:"tr",align:null},"x"),(0,r.kt)("td",{parentName:"tr",align:null},"x")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"Standard"),(0,r.kt)("td",{parentName:"tr",align:null},"x"),(0,r.kt)("td",{parentName:"tr",align:null}),(0,r.kt)("td",{parentName:"tr",align:null})),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"DISA STIG"),(0,r.kt)("td",{parentName:"tr",align:null}),(0,r.kt)("td",{parentName:"tr",align:null},"x"),(0,r.kt)("td",{parentName:"tr",align:null},"x")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"DISA STIG with GUI"),(0,r.kt)("td",{parentName:"tr",align:null}),(0,r.kt)("td",{parentName:"tr",align:null},"x"),(0,r.kt)("td",{parentName:"tr",align:null},"x")))))}u.isMDXComponent=!0}}]);